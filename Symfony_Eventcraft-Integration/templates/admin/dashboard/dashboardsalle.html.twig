{% extends 'admin/layout.html.twig' %}

{% block title %}Gestion des salles - Admin EventCraft{% endblock %}

{% block content %}
<div class="admin-header">
    <h1 class="admin-title">Gestion des salles</h1>
</div>

<div class="row">
    <div class="col-md-6 col-xl-3 mb-4">
        <div class="stats-card bg-primary text-white">
            <div class="stats-card-body">
                <div class="stats-card-value">{{ salles|length }}</div>
                <div class="stats-card-title">Total Salles</div>
            </div>
            <div class="stats-card-icon">
                <i class="fas fa-door-open"></i>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-xl-3 mb-4">
        <div class="stats-card bg-success text-white">
            <div class="stats-card-body">
                <div class="stats-card-value">{{ salles|filter(s => s.prix < 100)|length }}</div>
                <div class="stats-card-title">Salles économiques</div>
                <div class="stats-card-subtitle">Moins de 100DT</div>
            </div>
            <div class="stats-card-icon">
                <i class="fas fa-euro-sign"></i>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-xl-3 mb-4">
        <div class="stats-card bg-info text-white">
            <div class="stats-card-body">
                <div class="stats-card-value">{{ salles|filter(s => s.qualite == 'luxe')|length }}</div>
                <div class="stats-card-title">Salles luxe</div>
            </div>
            <div class="stats-card-icon">
                <i class="fas fa-crown"></i>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-xl-3 mb-4">
        <div class="stats-card bg-warning text-white">
            <div class="stats-card-body">
                <div class="stats-card-value">{{ salles|filter(s => s.capacite >= 100)|length }}</div>
                <div class="stats-card-title">Grandes salles</div>
                <div class="stats-card-subtitle">100+ personnes</div>
            </div>
            <div class="stats-card-icon">
                <i class="fas fa-users"></i>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12 mb-4">
        <div class="data-card">
            <div class="data-card-header">
                <h2 class="data-card-title">Dernières salles ajoutées</h2>
                <a href="{{ path('app_admin_salles_full') }}" class="btn btn-outline-primary btn-sm">
                    Voir toutes les salles
                </a>
            </div>
            <div class="data-card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nom</th>
                                <th>Capacité</th>
                                <th>Localisation</th>
                                <th>Équipement</th>
                                <th>Qualité</th>
                                <th>Prix</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for salle in salles|slice(0, 5) %}
                                <tr>
                                    <td>{{ salle.idSalle }}</td>
                                    <td>{{ salle.nomSalle }}</td>
                                    <td>{{ salle.capacite }} personnes</td>
                                    <td>{{ salle.locationSalle }}</td>
                                    <td>{{ salle.equipement }}</td>
                                    <td>
                                        {% if salle.qualite == 'luxe' %}
                                            <span class="badge bg-purple">Luxe</span>
                                        {% elseif salle.qualite == 'premium' %}
                                            <span class="badge bg-primary">Premium</span>
                                        {% else %}
                                            <span class="badge bg-secondary">Standard</span>
                                        {% endif %}
                                    </td>
                                    <td>{{ salle.prix }} DT</td>
                                    <td>
                                        <a href="{{ path('app_admin_salles_full', {'id': salle.idSalle}) }}" class="btn btn-sm btn-info" title="Voir">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <a href="{{ path('app_admin_salles_full', {'id': salle.idSalle}) }}" class="btn btn-sm btn-warning" title="Modifier">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <form method="post" action="{{ path('app_admin_salles_full', {'id': salle.idSalle}) }}" style="display: inline-block;" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cette salle ?');">
                                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ salle.idSalle) }}">
                                            <button class="btn btn-sm btn-danger" title="Supprimer">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </form>
                                    </td>
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="8" class="text-center py-4">
                                        <p class="text-muted mb-0">Aucune salle enregistrée pour le moment.</p>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bg-purple {
        background-color: #6f42c1;
    }
</style>
{% endblock %}